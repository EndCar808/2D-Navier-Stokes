%---------------------------PREAMBLE-------------------------------------------- %
\documentclass[9pt]{article}
% \documentclass[9pt]{amsart}
% \documentclass[9pt]{revtex4-2}


%------------------- PACKAGES 

\usepackage{graphicx}
	\graphicspath{ {plots/} }
\usepackage{caption}
\usepackage{epstopdf}
\usepackage{pdfpages}
\usepackage{array}
\usepackage{ulem}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
	\newtheorem{definition}{Definition}[section]
	\newtheorem*{remark}{Remark}
	\newtheorem{theorem}{Theorem}[section]
	\newtheorem{corollary}{Corollary}[theorem]
	\newtheorem{lemma}[theorem]{Lemma}
\usepackage{mathrsfs}
\usepackage{color}
\usepackage{tikz}
	\usetikzlibrary{tikzmark}
\usepackage{enumerate}
\usepackage{array}
\usepackage{wrapfig}
\usepackage{enumitem}
\usepackage{bm}
\usepackage{booktabs}
\usepackage{siunitx}
\usepackage{authblk}
\usepackage{cancel}
\usepackage{listings}
\usepackage[utf8]{inputenc}
% \usepackage[table]{xcolor}

\usepackage[unicode,psdextra, colorlinks=true, linkcolor=black, citecolor=black, urlcolor=blue, breaklinks]{hyperref}[2012/08/13]


\setlength{\arrayrulewidth}{0.5mm}
% \setlength{\tabcolsep}{10pt}
\renewcommand{\arraystretch}{1.0}


%------------------ USEFULL MACROS ------------------%
%-- MISC
\newcommand{\comment}[1]{}                                % for adding an inline comment
\makeatletter 											  % This entire thing is for redefining *matrix environment in amsmath so that you can specify the line spacing in a matrix by  - \begin{pmatrix}[1.5]
\renewcommand*\env@matrix[1][\arraystretch]{%             
  \edef\arraystretch{#1}%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{*\c@MaxMatrixCols c}}
\makeatother

%-- DERIVATIVES
\newcommand{\der}[2]{\frac{\mathrm{d}#1}{\mathrm{d}#2}}          	 % first derivative
\newcommand{\dder}[2]{\frac{\mathrm{d}^{2}#1}{\mathrm{d}#2^{2}}}	 % second derivative
\newcommand{\nder}[3]{\frac{\mathrm{d}^{#3}#1}{\mathrm{d}#2^{#3}}}   % nth derivative
\newcommand{\pder}[2]{\frac{\partial #1}{\partial #2}}               % first partial derivative
\newcommand{\ppder}[2]{\frac{\partial^2 #1}{\partial {#2}^2}}        % second partial derivative
\newcommand{\npder}[3]{\frac{\partial^{#3} #1}{\partial {#2}^{#3}}}  % second partial derivative

%-- SUMMATION
\newcommand{\sumk}[3]{\sum_{#1 = #2}^{#3}}        			% sum over #1 with limits #2 #3
\newcommand{\sumkk}[2]{\sum_{#1, #2} }         	  			% sum over #1 and #2 no limits
\newcommand{\sumkkdom}[3]{\sum_{#1 , #2 \in #3}}   			% sum over #1 and #2 with domain specified

%-- RESEARCH RELATED
\newcommand{\uhat}[1]{\hat{u}_{#1}}      				          % quick fourier mode
\newcommand{\akak}[2]{a_{#1}a_{#2}}      				          % quick convolution amplitudes
\newcommand{\akakak}[3]{\frac{a_{#1}a_{#2}}{a_{#3}}}      	      % quick convolution amplitudes
\newcommand{\triadexpl}[3]{\phi_{#1} + \phi_{#2} - \phi_{#3}}      % quick triad explicitly
\newcommand{\triad}[3]{\varphi_{#1, #2}^{#3}}                     % quick varphi triad
\newcommand{\ii}{\mathrm{i}}      								  % imaginary i
\newcommand{\e}{\mathrm{e}}      								  % e
\newcommand{\Mod}[1]{\ (\mathrm{mod}\ #1)}
\newcommand{\grad}[1]{\nabla{#1}}								% gradient operator
\newcommand{\curl}[1]{\nabla \times {#1}}								% gradient operator
\newcommand{\diverg}[1]{\nabla \cdot {#1}}			% divergence operator
\newcommand{\bfu}{\mathbf{u}}											% vector u in bold font
\newcommand{\omegahat}[1]{\hat{\omega}_{ \mathbf{#1} } }								% gradient operator
\newcommand{\bfx}{\mathbf{x}}								% gradient operator
\newcommand{\bfk}{\mathbf{k}}								% gradient operator
\newcommand{\bfkn}[1]{\mathbf{k}_{#1}}								% gradient operator



%-- CODE SNIPPETS
\newcommand{\code}[1]{\texttt{#1}}





%-------- PAGE STYLE & MARGIN SIZE
% \pagestyle{plain} \setlength{\oddsidemargin}{0.05in}
% \setlength{\evensidemargin}{0.05in} \setlength{\topmargin}{0in}
% \setlength{\footskip}{1.05in} \setlength{\headsep}{0in}
% \setlength{\textwidth}{6.4in} \setlength{\textheight}{8.25in}
\usepackage[a4paper, margin=0.5cm]{geometry}




\title{\textbf{Phase Dynamics: 2D Navier Stokes}}

\author[$1$]{E. M. Carroll}
\author[$1$]{M. D. Bustamante}
\affil[$1$]{Department of Mathematics and Statistics, University College Dublin, Dublin, Ireland} 





\begin{document}


\maketitle	


\section{2D Ekman Navier Stokes Equations}

We start with the 2D incompressible Navier Stokes equations with an Ekman friction and hyperviscosity

\begin{align}
	\pder{\bfu}{t} + \left(\bfu \cdot \nabla \right) \bfu &= -\frac{\nabla p}{\rho} - \nu (-\nabla^2)^n \bfu - \alpha \bfu + \mathbf{F} \label{eq:conserv_momentum} \\
	\diverg{\bfu} &= 0 
	\label{eq:conserv_mass}
\end{align}
where $\bfu = (u, v, w)^{T} \in \mathbf{\Omega} = [0, 2 \pi]^3$ is the velocity vector field, $p$ is the scalar pressure field, $\rho$ is the density, $\nu$ is the kinematic viscosity, $\mathbf{F}$ is the forcing and $\alpha$ is the Ekman friction coeficient. The Ekman friction term is introduced to remove energy from the flow at larges scales making the inverse energy cascade stationary.

Recal that 

\begin{align}
	\bfu = (u, v, w)^{T}, \quad \text and \quad \grad{\bfu} = \left(\pder{u}{x}, \pder{v}{y}, \pder{w}{z} \right)^{T}
\end{align}
while


\begin{align}
	\left(\bfu \cdot \nabla \right) &= (u, v, w) \cdot  \begin{pmatrix}
           \pder{}{x} \\
           \pder{}{y} \\
           \pder{}{z}\\
         \end{pmatrix} \notag\\
         &\left(u\pder{}{x} + v\pder{}{y} + w\pder{}{z}\right) \notag
\end{align}
therefore

\begin{align}
	\left(\bfu \cdot \nabla \right) \bfu &= \left(u\pder{}{x} + v\pder{}{y} + w\pder{}{z}\right) \begin{pmatrix}
           u \\
           v \\
           w\\
         \end{pmatrix} \notag\\
         & = \begin{pmatrix}
           u\pder{u}{x} + v\pder{u}{y} + w\pder{u}{z} \\
           u\pder{v}{x} + v\pder{v}{y} + w\pder{v}{z} \\
           u\pder{w}{x} + v\pder{w}{y} + w\pder{w}{z}\\
         \end{pmatrix}. \notag
\end{align}


The system in equations (\ref{eq:conserv_momentum}) and (\ref{eq:conserv_mass}) can be rewritten in vorticity formulation in the following way. First note the vorticity is given by 

\begin{align}
	\omega = \curl{\bfu}
	\label{eq:vort}
\end{align}
and second, we make use of the following identity

\begin{align}
	\left(\bfu \cdot \nabla \right)\bfu = \nabla \left( \frac{1}{2} \bfu \cdot \bfu \right) - \bfu \times \curl{\bfu}
	\label{eq:nolinear_identity}
\end{align}

Substituting (\ref{eq:nolinear_identity}) into equation (\ref{eq:conserv_momentum}) and taking the curl we get

\begin{align}
	\curl{\left(\pder{\bfu}{t} + \nabla \left( \frac{1}{2} \bfu \cdot \bfu \right) - \bfu \times \curl{\bfu}\right)} &= \curl{\left( -\frac{\nabla p}{\rho} - \nu (-\nabla^2)^n  \bfu - \alpha \bfu + \mathbf{F} \right)} \notag \\
	\pder{\curl{\bfu}}{t} + \curl{\nabla \left( \frac{1}{2} \bfu \cdot \bfu \right)} - \curl{\bfu \times \curl{\bfu}} &= -\frac{1}{\rho}\curl{\grad{p}} - \nu \curl{(-\nabla^2)^n \bfu } - \alpha \curl{\omega} + \curl{\mathbf{F}} \notag,
\end{align}
using (\ref{eq:vort}) and noting that the curl of the gradient is 0 we get 

\begin{align}
	\pder{\omega}{t} - \curl{\left( \bfu  \times \omega\right)} = - \nu (-\nabla^2)^n \omega  - \alpha \omega + \curl{\mathbf{F}}.
\end{align}
We also make use of the following

\begin{align}
	\curl{\left( \bfu  \times \omega\right)} &= -\omega \left(\diverg{\bfu} \right) + \left( \omega \cdot \nabla\right)\bfu - \left(\bfu \cdot \nabla\right)\omega \notag \\
	&= - \left(\bfu \cdot \nabla\right)\omega
\end{align}
since $\omega = \left(0, 0, \pder{v}{x} - \pder{u}{y}\right)^{T}$ and $ \left(\bfu \cdot \nabla\right)\omega = \left(0 \pder{u}{x}, 0 \pder{v}{y}, 0 \omega\right)^T = \mathbf{0}$ and we have used the incompresibilty condition for the first term. 
Therefore the 2D incompressible Ekman Nvaier Stokes equations in vorticity form are 

\begin{align}
	\pder{\omega}{t} + \left(\bfu \cdot \nabla\right)\omega = - \nu (-\nabla^2)^n \omega - \alpha \omega +  \curl{F}
\end{align}

To ensure the uniqueness of solutions and that the incompressibilty condition is satisfied, once the vorticity $\omega$ is known, we must find the stream function $\psi = (0, 0, \psi)^T$ for the flow by solving the following equation

\begin{align}
	\Delta\psi = -\omega.
\end{align}
This comes from the fact that the stream function is defined in such a way that 

\begin{align}
	u = \pder{\psi}{y}, \quad v = -\pder{\psi}{x}
	\label{eq:stream_function}
\end{align}
and so

\begin{align}
\nabla \cdot \bfu = \pder{u}{x} + \pder{v}{y} = \psi_{y x}-\psi_{x y}=0.
\end{align}
Once the stream function is known the real space velocity can then be found using (\ref{eq:stream_function}).

In summary, we have the following system

\begin{align}
	\pder{\omega}{t} + \left(\bfu \cdot \nabla\right)\omega &= -\nu (-\nabla^2)^n\omega - \alpha \omega +  \curl{F}, \label{eq:vort_eq}\\
	\Delta\psi &= -\omega. \label{eq:laplace}
\end{align}


\section{Vorticity Equation in Fourier Space}

To solve this system we perform a Fourier decomposition of the scalar vorticity field in space

\begin{align}
	\omega(\mathbf{x}, t) = \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}}\hat{\omega}_{\mathbf{k}}(t)\e^{\ii \mathbf{k}\cdot \mathbf{x}}
	\label{eq:fourier_decomp}
\end{align}
where $\bfx = (x, y)$ and $\bfk = (k_x, k_y)$. The various terms in (\ref{eq:vort_eq}) become

\begin{align}
	\pder{\omega}{t} = \sum_{\bfk \in \mathbb{Z}^2\setminus \mathbf{0}} \pder{\omegahat{k}}{t} \e^{\ii \mathbf{k}\cdot \mathbf{x}}
\end{align}

\begin{align}
	-\alpha\omega = -\alpha \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}}\hat{\omega}_{\mathbf{k}}(t)\e^{\ii \mathbf{k}\cdot \mathbf{x}}
\end{align}

\begin{align}
	- \nu (-\nabla^2)^n  \omega = - \nu \left(\left(\ppder{}{x}\right)^n\omega + \left(\ppder{}{y}^n\right)\omega\right) &= -\nu\left(\sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} \left(k_x^2\right)^n\hat{\omega}_{\mathbf{k}}\e^{\ii \mathbf{k}\cdot \mathbf{x}} +\sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} \left(k_y^2\right)^n\hat{\omega}_{\mathbf{k}}\e^{\ii \mathbf{k}\cdot \mathbf{x}} \right)\notag \\
	&= -\nu\sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} |\bfk|^{2n}\hat{\omega}_{\mathbf{k}}\e^{\ii \mathbf{k}\cdot \mathbf{x}}
\end{align}
with the nonlinear term becoming 

\begin{align}
\left(\bfu \cdot \nabla\right) \omega	= u\pder{\omega}{x} + v\pder{\omega}{y} &= \pder{\psi}{y}\pder{\omega}{x} - \pder{\psi}{x}\pder{\omega}{y} \notag \\
&= \pder{}{y}\left(-\Delta\right)^{-1}\omega\pder{\omega}{x} - \pder{}{x}\left(-\Delta\right)^{-1}\omega\pder{\omega}{y} \notag \\
&= \sum_{\mathbf{k}_1\in \mathbb{Z}^2\setminus \mathbf{0}} \frac{-\ii k_{1y}}{|\bfkn{1}|^2}\hat{\omega}_{\bfkn{1}} \e^{\ii \bfkn{1}\cdot \mathbf{x}} \sum_{\mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}} -\ii k_{2x}\hat{\omega}_{\bfkn{2}} \e^{\ii \bfkn{2}\cdot \mathbf{x}} \notag\\
&\qquad - \sum_{\mathbf{k}_1\in \mathbb{Z}^2\setminus \mathbf{0}} \frac{-\ii k_{1x}}{|\bfkn{1}|^2}\hat{\omega}_{\bfkn{1}} \e^{\ii \bfkn{1}\cdot \mathbf{x}} \sum_{\mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}} -\ii k_{2y}\hat{\omega}_{\bfkn{2}} \e^{\ii \bfkn{2}\cdot \mathbf{x}} \notag \\
&= \sum_{\mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\frac{k_{1x}k_{2y} - k_{1y}k_{2x}}{|\bfkn{1}|^2} \omegahat{\bfkn{1}}\omegahat{\bfkn{2}} \e^{\ii (\bfkn{1} + \bfkn{2}) \cdot \bfx}
\end{align}
Notice the in the above expression the domain of summation is symmetric about the origin however the summand is not symmetric. We can make the summand symmetric by taking the average of the summation above and when $\bfkn{1} \rightarrow \bfkn{2}$ in the above epxression. Therefor the symmetric version of the nonlinear term in the Fourier space vorticity is

\begin{align}
	\left(\bfu \cdot \nabla\right) \omega = \frac{1}{2} \sum_{\mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\left(k_{1x}k_{2y} - k_{1y}k_{2x}\right) \left(\frac{1}{|\bfkn{1}|^2} - \frac{1}{|\bfkn{2}|^2}\right) \omegahat{\bfkn{1}}\omegahat{\bfkn{2}} \e^{\ii (\bfkn{1} + \bfkn{2}) \cdot \bfx}
\end{align}
Putting them all together and performing the following transform

\begin{align}
	\omegahat{\bfk} (t)= \frac{1}{(2\pi)^2}\int_0^{2\pi}\omega(\bfx, t)\e^{-\ii \bfk \cdot \bfx}\mathrm{d}\mathbf{x}
\end{align}
the system in Fourier space becomes

\begin{align}
	\der{\omegahat{k}}{t} = \frac{1}{2}	\sum_{\mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\left(k_{1x}k_{2y} - k_{1y}k_{2x}\right) \left(\frac{1}{|\bfkn{1}|^2} - \frac{1}{|\bfkn{2}|^2}\right) \omegahat{\bfkn{1}}\omegahat{\bfkn{2}} \delta_{\bfkn{1}, \bfkn{2}}^{\bfk} - \nu |\bfk|^{2n}\omegahat{k} - \alpha\omegahat{k} + \hat{f}_{\bfk}
	\label{eq:vort_eqn_fourier_space}
\end{align}

\section{Enstrophy Flux}

Using (\ref{eq:enstrophy_fourier}) we can find the rate of change of enstrophy as the following

\begin{align}
\der{\mathcal{E}}{t} = 2\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} \der{a_{\bfk}^2}{t}  = 2\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} 2 a_{\bfk} \dot{a}_{\bfk} = 4\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} a_{\bfk} \dot{a}_{\bfk}
\end{align}
or, noting that $a_{\bfk}^2 = |\hat{\omega}_{\bfk}|^2 = \hat{\omega}_{\bfk}\hat{\omega}_{\bfk}^{*}$, the rate of change of the enstrohpyh can be written in terms of the Fourier vorticity


\begin{align}
	\der{\mathcal{E}}{t} = 2\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} \der{a_{\bfk}^2}{t} = 2\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}}\der{|\hat{\omega}_{\bfk}|^2}{t} = 2\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} (\hat{\omega}_{\bfk} \dot{\hat{\omega}}^{*}_{\bfk} + \dot{\hat{\omega}}_{\bfk} \hat{\omega}^{*}_{\bfk})
\end{align}

Similarly, using the equation of motion for the Fourier vorticity in (\ref{eq:vort_eqn_fourier_space}) we can find an expression for the rate of change of enstrophy by multipling across by $\omegahat{k}^*$, adding the complex conjugate, averaging over $\bfk$ and taking the real part of both sides

\begin{align}
	\omegahat{k}^*\der{\omegahat{k}}{t} &= \frac{1}{2}	\sum_{\mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\left(k_{1x}k_{2y} - k_{1y}k_{2x}\right) \left(\frac{1}{|\bfkn{1}|^2} - \frac{1}{|\bfkn{2}|^2}\right) \omegahat{\bfkn{1}}\omegahat{\bfkn{2}}\omegahat{k}^* \delta_{\bfkn{1}, \bfkn{2}}^{\bfk} - \nu |\bfk|^{2n}\omegahat{k}\omegahat{k}^* - \alpha\omegahat{k}\omegahat{k}^* + \hat{f}_{\bfk} \omegahat{k}^* + c. c. \notag \\
	\sum_{\bfk}\left(\omegahat{k}^*\dot{\hat{\omega}}_\bfk + \omegahat{k}\dot{\hat{\omega}}^*_\bfk\right)&= \frac{1}{2}	\sum_{\bfk, \mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\left(k_{1x}k_{2y} - k_{1y}k_{2x}\right) \left(\frac{1}{|\bfkn{1}|^2} - \frac{1}{|\bfkn{2}|^2}\right) \omegahat{\bfkn{1}}\omegahat{\bfkn{2}}\omegahat{k}^* \delta_{\bfkn{1}, \bfkn{2}}^{\bfk} - \nu \sum_{\bfk}|\bfk|^{2n} a_{\bfk}^2 - \alpha\sum_{\bfk} a_{\bfk}^2 + \sum_{\bfk}\hat{f}_{\bfk} \omegahat{k}^* + c. c. \notag \\
	\frac{1}{2\pi^2}\der{\mathcal{E}}{t} &= \frac{1}{2}	\sum_{\bfk, \mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\left(k_{1x}k_{2y} - k_{1y}k_{2x}\right) \left(\frac{1}{|\bfkn{1}|^2} - \frac{1}{|\bfkn{2}|^2}\right) (\omegahat{\bfkn{1}}\omegahat{\bfkn{2}}\omegahat{k}^* \delta_{\bfkn{1}, \bfkn{2}}^{\bfk} + c.c.) - 2\nu \sum_{\bfk}|\bfk|^{2n} a_{\bfk}^2 - 2\alpha\sum_{\bfk} a_{\bfk}^2 \notag \\
	&\qquad \qquad \qquad \qquad+ \sum_{\bfk}(\hat{f}_{\bfk} \omegahat{k}^* + c. c.)\notag \\
	\der{\mathcal{E}}{t} &= 2\pi^2	\sum_{\bfk, \mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\left(k_{1x}k_{2y} - k_{1y}k_{2x}\right) \left(\frac{1}{|\bfkn{1}|^2} - \frac{1}{|\bfkn{2}|^2}\right) a_{\bfkn{1}} a_{\bfkn{2}} a_{\bfk} \cos(\phi_{\bfkn{1}} + \phi_{\bfkn{2}} - \phi_{\bfk}) \delta_{\bfkn{1}, \bfkn{2}}^{\bfk} \notag \\ & \qquad \qquad \qquad \qquad- 4\pi^2\nu \sum_{\bfk}|\bfk|^{2n} a_{\bfk}^2 - 4\pi^2\alpha\sum_{\bfk} a_{\bfk}^2 + 4\pi^2\sum_{\bfk}a_\bfk\Re\left\{\hat{f}_{\bfk} \e^{-\ii\phi_\bfk}\right\} \notag \\
	&= \Pi - \epsilon + \mathcal{I}
\end{align}
where $\Pi, \epsilon$ and $\mathcal{I}$ are the enstrophy flux in/out of the domain enstrophy dissipation and forcing input.


\section{Energy Flux}

Using the Fourier vorticity version of the total kinetic energy the rate of change of energy follows in a similar fashion

\begin{align}
	\der{\mathcal{K}}{t} = 2\pi^2\sum_{\bfk}  \frac{1}{|\bfk|^2}\der{a_\bfk^2}{t} =4\pi^2\sum_{\bfk} a_\bfk \frac{\dot{a}_\bfk}{|\bfk|^2}
\end{align}

and 

\begin{align}
	\der{\mathcal{K}}{t} &= 2\pi^2	\sum_{\bfk, \mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\left(k_{1x}k_{2y} - k_{1y}k_{2x}\right) \left(\frac{1}{|\bfkn{1}|^2} - \frac{1}{|\bfkn{2}|^2}\right) \left( \frac{1}{|\bfk|^2}\right)a_{\bfkn{1}} a_{\bfkn{2}} a_{\bfk} \cos(\phi_{\bfkn{1}} + \phi_{\bfkn{2}} - \phi_{\bfk})\delta_{\bfkn{1}, \bfkn{2}}^{\bfk} \notag \\ & \qquad \qquad \qquad \qquad- 4\pi^2\nu \sum_{\bfk}|\bfk|^{2n - 1} a_{\bfk}^2 - 4\pi^2\alpha\sum_{\bfk} \frac{a_\bfk^2}{|\bfk|^2} + 4\pi^2\sum_{\bfk}\frac{a_\bfk}{|\bfk|^2}\Re\left\{\hat{f}_{\bfk} \e^{-\ii\phi_\bfk}\right\}
\end{align}

\section{System Quantities}

\subsection{Enstrophy}

The total Enstrophy for incompressible flows is defined as 

\begin{align}
	\mathcal{E}(\bfu) = \frac{1}{2}\int_{0}^{2\pi} |\curl{\bfu}|^2 \mathrm{d}\bfx \Rightarrow \frac{1}{2}\int_{0}^{2\pi} |\bm{\omega}|^2 \mathrm{d}\bfx = \frac{1}{2}\int_{0}^{2\pi} \omega^2 \mathrm{d}\bfx .
	\label{eq:enstrophy_def}
\end{align}

Using (\ref{eq:fourier_decomp}) the enstrophy in Fourier space is given as 

\begin{align}
	\mathcal{E}(\omegahat{k}) &= \frac{1}{2}\int_{0}^{2\pi} \left(\sum_{\mathbf{k}_1\in \mathbb{Z}^2\setminus \mathbf{0}}\hat{\omega}_{\mathbf{k}_1}\e^{\ii \mathbf{k}_1\cdot \mathbf{x}}\right)\left(\sum_{\mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\hat{\omega}_{\mathbf{k}_2}\e^{\ii \mathbf{k}_2\cdot \mathbf{x}}\right)  \mathrm{d}\bfx, \notag \\
	&= \frac{1}{2}\int_{0}^{2\pi}\sum_{\mathbf{k}_1, \bfkn{2}\in \mathbb{Z}^2\setminus \mathbf{0}}\hat{\omega}_{\mathbf{k}_1}\hat{\omega}_{\mathbf{k}_2} \e^{\ii \left(\mathbf{k}_1 + \bfkn{2}\right)\cdot \mathbf{x}}\mathrm{d}\bfx \notag \\
	&=\frac{1}{2}\sum_{\mathbf{k}_1, \bfkn{2}\in \mathbb{Z}^2\setminus \mathbf{0}}\hat{\omega}_{\mathbf{k}_1}\hat{\omega}_{\mathbf{k}_2} \int_{0}^{2\pi} \e^{\ii \left(\mathbf{k}_1 + \bfkn{2}\right)\cdot \mathbf{x}}\mathrm{d}\bfx \notag \\
	&= \frac{1}{2}\sum_{\mathbf{k}_1, \bfkn{2}\in \mathbb{Z}^2\setminus \mathbf{0}}\hat{\omega}_{\mathbf{k}_1}\hat{\omega}_{\mathbf{k}_2} \delta_{\bfkn{1}, \bfkn{2}} 4 \pi^2 \notag \\
	&= 2 \pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}}|\hat{\omega}_{\mathbf{k}} |^2 \notag \\
	&= 2 \pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} a_{\bfk}^2
	\label{eq:enstrophy_fourier}
\end{align}
where we have let $\bfkn{2} = - \bfkn{1}$ (and relabled as $\bfk$)


\subsection{Kinetic Energy}

The total system energy is defined as

\begin{align}
	\mathcal{K}(\bfu) = \frac{1}{2}\int_0^{2 \pi}|\bfu|^2\mathrm{d}\bfx = \frac{1}{2}\int_0^{2\pi} |(u, v)^{T}|^2 \mathrm{d}\bfx 
\end{align}

Using (\ref{eq:fourier_decomp}) again the total energy in Fourier space becomes

\begin{align}
\mathcal{K}(\hat{u}_{\bfk})	&= \frac{1}{2}\int_0^{2\pi} \left(\sum_{\mathbf{k}_1\in \mathbb{Z}^2\setminus \mathbf{0}}\hat{u}_{\mathbf{k}_1}\e^{\ii \mathbf{k}_1\cdot \mathbf{x}}\right)\left(\sum_{\mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\hat{u}_{\mathbf{k}_2}\e^{\ii \mathbf{k}_2\cdot \mathbf{x}}\right) + \left(\sum_{\mathbf{k}_1\in \mathbb{Z}^2\setminus \mathbf{0}}\hat{v}_{\mathbf{k}_1}\e^{\ii \mathbf{k}_1\cdot \mathbf{x}}\right)\left(\sum_{\mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\hat{v}_{\mathbf{k}_2}\e^{\ii \mathbf{k}_2\cdot \mathbf{x}}\right) \mathrm{d}\bfx \notag\\
	&= \frac{1}{2}\int_0^{2\pi} \sum_{\mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}} (\hat{u}_{\mathbf{k}_1}\hat{u}_{\mathbf{k}_2} + \hat{v}_{\mathbf{k}_1}\hat{v}_{\mathbf{k}_2}) \e^{\ii (\mathbf{k}_1 + \mathbf{k}_2)\cdot \mathbf{x}} \mathrm{d}\bfx \notag \\
	&= \frac{1}{2}\sum_{\mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}} (\hat{u}_{\mathbf{k}_1}\hat{u}_{\mathbf{k}_2} + \hat{v}_{\mathbf{k}_1}\hat{v}_{\mathbf{k}_2}) \int_0^{2\pi} \e^{\ii (\mathbf{k}_1 + \mathbf{k}_2)\cdot \mathbf{x}} \mathrm{d}\bfx \notag \\
	&= \frac{1}{2}\sum_{\mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}} (\hat{u}_{\mathbf{k}_1}\hat{u}_{\mathbf{k}_2} + \hat{v}_{\mathbf{k}_1}\hat{v}_{\mathbf{k}_2}) (2\pi)^2 \delta_{\bfkn{1}, \bfkn{2}} \notag \\
	&= 2\pi^2 \sum_{\mathbf{k}_1\in \mathbb{Z}^2\setminus \mathbf{0}} (\hat{u}_{\mathbf{k}_1}\hat{u}_{-\mathbf{k}_1} + \hat{v}_{\mathbf{k}_1}\hat{v}_{-\mathbf{k}_{1}}) \notag \\
	&= 2\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} (|\hat{u}_{\mathbf{k}}|^2 + |\hat{v}_{\mathbf{k}}|^2)
	\label{eq:energy_u_fourier}
\end{align}
where we have let $\bfkn{2} = - \bfkn{1}$ (and relabled as $\bfk$).

From here we can express the total energy in terms of the vorticity 

\begin{align}
E(\hat{\omega}_{\bfk}) &=  2\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} \left(\left|\mathcal{F}\left[\pder{\psi}{y}\right]_k\right|^2 + \left|\mathcal{F}\left[-\pder{\psi}{x}\right]_k\right|^2 \right) \notag \\
&= 2\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} (|\ii k_{y}\hat{\psi}_{\mathbf{k}}|^2 + |\ii k_x \hat{\psi}_{\mathbf{k}}|^2) \notag \\
&= 2\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} (|\ii k_{y}|^2 + |\ii k_x|^2)|\hat{\psi}_{\mathbf{k}}|^2 \notag \\
&= 2\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} |\bfk|^2\frac{|\hat{\omega}_{\mathbf{k}}|^2}{|\bfk|^4} \notag \\
&= 2\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} \frac{|\hat{\omega}_{\mathbf{k}}|^2}{|\bfk|^2} \notag \\
&= 2\pi^2 \sum_{\mathbf{k}\in \mathbb{Z}^2\setminus \mathbf{0}} \frac{a_{\mathbf{k}}^2}{|\bfk|^2}
\label{eq:energy_w_fourier}
\end{align}

\subsection{Palinstrophy}

 The total palinstrophy is defined as 

 \begin{align}
 \mathcal{P}(\bfu) = \frac{1}{2}\int_0^{2\pi} |\curl{\bm{\omega}}|^2\mathrm{d}\bfx
 \end{align}	
but $\curl{\bm{\omega}} = \grad{\omega}$ in 2D so the palinstrophy is given by

\begin{align}
\mathcal{P}(\bfu) = \frac{1}{2}\int_0^{2\pi} |\grad{\omega}|^2\mathrm{d}\bfx
\end{align}

Using (\ref{eq:fourier_decomp}) again the total palinstrophy in Fourier space becomes

\begin{align}
\mathcal{P}(\omegahat{k}) &= \frac{1}{2}\int_0^{2\pi} \left|\left(\mathcal{F}\left[\pder{\omega}{x}\right]_k, \mathcal{F}\left[\pder{\omega}{y}\right]_k \right)^{T} \right|^2\mathrm{d}\bfx \notag \\
&=  \frac{1}{2}\int_0^{2\pi} \left(\sum_{\mathbf{k}_1\in \mathbb{Z}^2\setminus \mathbf{0}}\ii k_{1x}\hat{\omega}_{\mathbf{k}_1}\e^{\ii \mathbf{k}_1\cdot \mathbf{x}}\right)\left(\sum_{\mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\ii k_{2x}\hat{\omega}_{\mathbf{k}_2}\e^{\ii \mathbf{k}_2\cdot \mathbf{x}}\right) + \left(\sum_{\mathbf{k}_1\in \mathbb{Z}^2\setminus \mathbf{0}}\ii k_{1y}\hat{\omega}_{\mathbf{k}_1}\e^{\ii \mathbf{k}_1\cdot \mathbf{x}}\right)\left(\sum_{\mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}}\ii k_{2y}\hat{\omega}_{\mathbf{k}_2}\e^{\ii \mathbf{k}_2\cdot \mathbf{x}}\right) \mathrm{d}\bfx \notag\\
&= \frac{1}{2}\int_0^{2\pi} \sum_{\mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}} -(k_{1x}k_{2x} + k_{1y}k_{2y})\hat{\omega}_{\bfkn{1}}\hat{\omega}_{\bfkn{2}}\e^{\ii (\bfkn{1} + \bfkn{2}) \cdot \bfx}\mathrm{d}\bfx \notag\\
&=  \frac{1}{2}\sum_{\mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}} -(k_{1x}k_{2x} + k_{1y}k_{2y})\hat{\omega}_{\bfkn{1}}\hat{\omega}_{\bfkn{2}}\int_0^{2\pi}\e^{\ii (\bfkn{1} + \bfkn{2}) \cdot \bfx}\mathrm{d}\bfx \notag\\
&=  \frac{1}{2}\sum_{\mathbf{k}_1, \mathbf{k}_2\in \mathbb{Z}^2\setminus \mathbf{0}} -(k_{1x}k_{2x} + k_{1y}k_{2y})\hat{\omega}_{\bfkn{1}}\hat{\omega}_{\bfkn{2}} 4\pi^2 \delta_{\bfkn{1}, \bfkn{2}}\mathrm{d}\bfx \notag\\
&=  2\pi^2 \sum_{\mathbf{k}_1, \in \mathbb{Z}^2\setminus \mathbf{0}} -(k_{1x}-k_{1x} + k_{1y}-k_{1y})\hat{\omega}_{\bfkn{1}}\hat{\omega}_{-\bfkn{1}} \mathrm{d}\bfx \notag\\
&=  2\pi^2 \sum_{\mathbf{k}, \in \mathbb{Z}^2\setminus \mathbf{0}} |\bfk|^2 |\hat{\omega}_{\bfk}|^2 \mathrm{d}\bfx \notag\\
&=  2\pi^2 \sum_{\mathbf{k}, \in \mathbb{Z}^2\setminus \mathbf{0}} |\bfk|^2 a_{\bfk}^2 \mathrm{d}\bfx \notag\\
\label{eq:palinstrophy_fourier}
\end{align}


\subsection{Validate System Quantities}

To validate the computation of the system quantities we will compute the various measures for the Taylor Green vortex initial condition which is given by

\begin{align}
u(x, y) &= \kappa\cos(\kappa x)\sin(\kappa y) \notag \\
v(x, y) &= -\kappa\sin(\kappa x)\cos(\kappa y)
\label{eq:taylor_green}
\end{align}
where $\kappa = 1$ 

The total kinetic energy

\begin{align}
\mathcal{K}(\bfu) &= \frac{1}{2}\int_0^{2\pi}|\bfu |^2 \mathrm{d}\bfx \notag \\
									&= \frac{1}{2}\int_0^{2\pi}\left(\cos^2(x)\sin^2(y) + \sin^2(x)\cos^2(y)\right) \mathrm{d}\bfx \notag \\
									&= \frac{1}{2}\int_0^{2\pi}\cos^2(x)\mathrm{d}x\int_0^{2\pi}\sin^2(y)\mathrm{d}y + \frac{1}{2}\int_0^{2\pi}\sin^2(x)\mathrm{d}x\int_0^{2\pi}\cos^2(y)\mathrm{d}y \notag \\
									&= \frac{1}{2}\int_0^{2\pi}\cos^2(x)\mathrm{d}x\int_0^{2\pi}\sin^2(y)\mathrm{d}y + \frac{1}{2}\int_0^{2\pi}\sin^2(x)\mathrm{d}x\int_0^{2\pi}\cos^2(y)\mathrm{d}y \notag \\
									&= \frac{1}{2}\int_0^{2\pi}\frac{\cos(2x) + 1}{2}\mathrm{d}x\int_0^{2\pi}\frac{1 - \cos^2(2x)}{2}\mathrm{d}y + \ldots \notag \\
									&= \frac{1}{2}\left[\frac{\frac{\sin(2x)}{2} + x}{2}\right]_0^{2\pi} \left[\frac{x - \frac{\sin(2x)}{2}}{2}\right]_0^{2\pi} + \ldots  \notag \\
									&= \frac{1}{2}\pi^2 + \frac{1}{2}\pi^2 \notag \\
									&= \pi^2.
\end{align}

The total enstrophy

\begin{align}
\mathcal{E}(\bfu) &= \frac{1}{2}\int_0^{2\pi} |\omega|^2\mathrm{d}\bfx \notag \\
									&= \frac{1}{2}\int_0^{2\pi} \left|\pder{v}{x} - \pder{u}{y}\right|^2 \mathrm{d}\bfx \notag \\
									&= \frac{1}{2}\int_0^{2\pi} |-2 \cos(x)\cos(y)|^2 \mathrm{d}\bfx \notag \\
									&= 2\int_0^{2\pi} \cos^2(x)\cos^2(y) \mathrm{d}\bfx \notag \\
									&= 2\int_0^{2\pi} \cos^2(x)\mathrm{d}x\int_0^{2\pi}\cos^2(y) \mathrm{d}y \notag \\
									&= 2 \pi^2
\end{align}

The total palinstrophy

\begin{align}
\mathcal{P}(\bfu) &= \frac{1}{2}\int_0^{2\pi} |\grad{\omega}|^2 \mathrm{d}\bfx \notag \\
									&= \frac{1}{2}\int_0^{2\pi} |\grad{-2\cos(x)\cos(y)}|^2 \mathrm{d}\bfx \notag \\
									&= \frac{1}{2}\int_0^{2\pi} 4\sin^2(x)\cos^2(y) + 4\cos^2(x)\sin^2(y) \mathrm{d}\bfx \notag \\
									&= 2\int_0^{2\pi} \sin^2(x)\mathrm{d}x\int_0^{2\pi}\cos^2(y)\mathrm{d}y + 2\int_0^{2\pi}\cos^2(x)\mathrm{d}x\int_0^{2\pi}\sin^2(y) \mathrm{d}y \notag \\
									&= 2\pi^2 + 2\pi^2 \notag \\
									&= 4\pi^2
\end{align}

The enstrophy and energy dissipation rates are then $2\nu$ times the palinstrophy and enstrophy respectively.


\end{document}